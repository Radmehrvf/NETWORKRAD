<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>NetworkRad Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        color-scheme: dark;
        --page-bg: #050505;
        --panel-bg: #0f0f0f;
        --panel-alt: #151515;
        --gold: #d4af37;
        --gold-soft: rgba(212, 175, 55, 0.15);
        --text-main: #f4f4f4;
        --text-muted: #a8a8a8;
        --border: rgba(255, 255, 255, 0.08);
        --danger: #ff6b6b;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        background: radial-gradient(circle at top, rgba(212, 175, 55, 0.08), transparent 55%),
          var(--page-bg);
        color: var(--text-main);
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        transition: opacity 0.35s ease;
      }

      body.page-switching {
        opacity: 0;
      }

      a {
        color: inherit;
        text-decoration: none;
      }

      .dash-header {
        position: sticky;
        top: 0;
        z-index: 10;
        background: rgba(5, 5, 5, 0.95);
        backdrop-filter: blur(12px);
        border-bottom: 1px solid var(--border);
        padding: 1.2rem clamp(1.25rem, 3vw, 3rem);
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        gap: 1.5rem;
      }

      .brand {
        display: flex;
        align-items: center;
        gap: 1rem;
        flex: 1 1 260px;
      }

      .logo-mark {
        width: 48px;
        height: 48px;
        border-radius: 14px;
        background: linear-gradient(145deg, #1b1b1b, #050505);
        border: 1px solid var(--gold-soft);
        display: grid;
        place-items: center;
        font-weight: 700;
        letter-spacing: 0.08em;
        color: var(--gold);
      }

      .brand-details h1 {
        font-size: clamp(1.4rem, 2vw, 1.8rem);
        margin: 0;
      }

      .brand-details .eyebrow {
        text-transform: uppercase;
        letter-spacing: 0.2em;
        font-size: 0.7rem;
        margin: 0 0 0.15rem;
        color: var(--text-muted);
      }

      .dash-nav {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        flex-wrap: wrap;
      }

      .page-switch {
        width: 100%;
        padding: 0 clamp(1.25rem, 3vw, 3rem);
        margin: clamp(1.25rem, 3vw, 2.5rem) auto 1.6rem;
        display: flex;
        justify-content: flex-end;
        flex-wrap: wrap;
        gap: 0.6rem;
        position: sticky;
        top: 90px;
        z-index: 8;
      }

      .page-switch[hidden] {
        display: none !important;
      }

      .email-toggle {
        display: inline-flex;
        gap: 0.4rem;
        background: rgba(0, 195, 255, 0.08);
        padding: 0.25rem;
        border-radius: 999px;
        border: 1px solid rgba(0, 195, 255, 0.3);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
      }

      .email-toggle-btn {
        border: none;
        background: transparent;
        padding: 0.65rem 1.75rem;
        border-radius: 999px;
        font-weight: 600;
        cursor: pointer;
        transition: background 0.2s ease, color 0.2s ease;
        min-width: 140px;
        font-size: 1rem;
      }

      #pageSwitchHome {
        color: #7dd3fc;
        border: 1px solid rgba(0, 195, 255, 0.45);
        background: rgba(0, 195, 255, 0.08);
      }

      #pageSwitchDashboard {
        color: #facc15;
        border: 1px solid rgba(212, 175, 55, 0.5);
        background: rgba(212, 175, 55, 0.08);
      }

      #pageSwitchHome:hover {
        background: rgba(0, 195, 255, 0.18);
        color: #e0faff;
      }

      #pageSwitchDashboard:hover {
        background: rgba(212, 175, 55, 0.18);
        color: #fff0c2;
      }

      #pageSwitchHome.active {
        background: linear-gradient(135deg, #36c3ff, #8be9ff);
        color: #04121f;
        border-color: rgba(0, 195, 255, 0.85);
      }

      #pageSwitchDashboard.active {
        background: linear-gradient(135deg, #f2c94c, #f7a81b);
        color: #140a00;
        border-color: rgba(212, 175, 55, 0.95);
      }

      .nav-link {
        padding: 0.55rem 1rem;
        border-radius: 999px;
        border: 1px solid transparent;
        color: var(--text-muted);
        background: transparent;
        font-weight: 500;
        cursor: pointer;
        transition: color 0.2s ease, border-color 0.2s ease, background 0.2s ease;
      }

      .nav-link:hover,
      .nav-link.active {
        color: var(--text-main);
        border-color: var(--gold-soft);
        background: rgba(212, 175, 55, 0.08);
      }

      .nav-link.logout {
        border-color: rgba(255, 255, 255, 0.12);
        color: var(--danger);
      }

      .nav-link.logout:hover {
        border-color: var(--danger);
        background: rgba(255, 107, 107, 0.08);
        color: #fff;
      }

      .dashboard-shell {
        width: min(1200px, 100%);
        margin: 0 auto;
        padding: clamp(1.5rem, 4vw, 3rem);
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 2rem;
      }

      .panel {
        border: 1px solid var(--border);
        background: linear-gradient(180deg, var(--panel-bg), var(--panel-alt));
        border-radius: 20px;
        padding: clamp(1.5rem, 3vw, 2.5rem);
        box-shadow: 0 15px 45px rgba(0, 0, 0, 0.35);
      }

      .profile-card {
        display: flex;
        flex-wrap: wrap;
        gap: clamp(1.5rem, 2vw, 3rem);
        align-items: center;
      }

      .profile-identity {
        display: flex;
        align-items: center;
        gap: 1.25rem;
        flex: 1 1 260px;
      }

      .profile-identity img {
        width: 96px;
        height: 96px;
        border-radius: 26px;
        object-fit: cover;
        border: 2px solid var(--gold);
        background: #0b0b0b;
      }

      .profile-identity h2 {
        margin: 0;
        font-size: clamp(1.3rem, 2vw, 1.7rem);
      }

      .profile-identity p {
        margin: 0.2rem 0 0;
        color: var(--text-muted);
      }

      .profile-meta {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 1rem;
        flex: 1 1 320px;
      }

      .profile-meta div {
        background: rgba(255, 255, 255, 0.02);
        padding: 1rem;
        border-radius: 16px;
        border: 1px solid rgba(255, 255, 255, 0.05);
      }

      .profile-meta dt {
        margin: 0;
        font-size: 0.8rem;
        color: var(--text-muted);
        letter-spacing: 0.08em;
        text-transform: uppercase;
      }

      .profile-meta dd {
        margin: 0.35rem 0 0;
        font-size: 1rem;
        font-weight: 600;
      }

      .status-badge {
        display: inline-flex;
        align-items: center;
        gap: 0.35rem;
        color: var(--gold);
      }

      .status-badge::before {
        content: '';
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: var(--gold);
        box-shadow: 0 0 12px rgba(212, 175, 55, 0.8);
      }

      .section-heading {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 1rem;
      }

      .section-heading h3 {
        margin: 0;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        font-size: 0.85rem;
        color: var(--text-muted);
      }

      .action-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 1.25rem;
      }

      .action-card {
        border: 1px solid var(--border);
        border-radius: 20px;
        padding: 1.35rem;
        background: rgba(0, 0, 0, 0.4);
        transition: transform 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
        display: flex;
        flex-direction: column;
        gap: 0.6rem;
        cursor: pointer;
      }

      .action-card:hover {
        transform: translateY(-4px);
        border-color: var(--gold);
        box-shadow: 0 12px 25px rgba(212, 175, 55, 0.15);
      }

      .action-card h4 {
        margin: 0;
        font-size: 1rem;
      }

      .action-card p {
        margin: 0;
        color: var(--text-muted);
        font-size: 0.9rem;
      }

      .action-icon {
        width: 36px;
        height: 36px;
        border-radius: 12px;
        background: rgba(212, 175, 55, 0.1);
        color: var(--gold);
        display: grid;
        place-items: center;
        font-size: 1.2rem;
      }

      .detail-section {
        border: 1px solid var(--border);
        border-radius: 18px;
        padding: 1.5rem;
        background: rgba(0, 0, 0, 0.35);
        margin-bottom: 1.25rem;
        scroll-margin-top: 90px;
        transition: border-color 0.3s ease, box-shadow 0.3s ease;
      }

      .detail-section h4 {
        margin: 0 0 0.4rem;
        font-size: 1.05rem;
      }

      .detail-section p {
        margin: 0;
        color: var(--text-muted);
        line-height: 1.6;
      }

      .section-highlight {
        border-color: var(--gold);
        box-shadow: 0 0 0 2px rgba(212, 175, 55, 0.2);
      }

      footer {
        border-top: 1px solid var(--border);
        padding: 1.5rem clamp(1.25rem, 3vw, 3rem);
        text-align: center;
        color: var(--text-muted);
        font-size: 0.85rem;
      }

      footer a {
        color: var(--gold);
        margin: 0 0.5rem;
      }

      @media (max-width: 900px) {
        .dash-header {
          padding: 1rem clamp(1rem, 4vw, 2rem);
          gap: 1rem;
        }

        .brand-details h1 {
          font-size: 1.35rem;
        }

        .dash-nav {
          gap: 0.5rem;
          flex-wrap: wrap;
        }

        .dash-nav .nav-link {
          padding: 0.55rem 1.1rem;
          font-size: 0.95rem;
        }

        .logo-mark {
          width: 44px;
          height: 44px;
        }
      }

      @media (max-width: 700px) {
        .dash-header {
          flex-direction: column;
          align-items: flex-start;
          padding: 0.65rem 0.9rem;
          gap: 0.7rem;
        }

        .dash-nav {
          width: 100%;
          justify-content: space-between;
          gap: 0.3rem;
          row-gap: 0.35rem;
        }

        .page-switch {
          justify-content: flex-start;
          padding: 0 1.25rem;
        }

        .profile-identity {
          flex-direction: column;
          align-items: flex-start;
        }

        .brand {
          flex-direction: column;
          gap: 0.4rem;
        }

        .brand-details h1 {
          font-size: 1.1rem;
          margin: 0;
        }

        .brand-details .eyebrow {
          font-size: 0.65rem;
        }

        .dash-nav .nav-link {
          padding: 0.35rem 0.75rem;
          font-size: 0.82rem;
        }

        .logo-mark {
          width: 38px;
          height: 38px;
          font-size: 1rem;
        }

        .profile-identity img {
          width: 60px;
          height: 60px;
        }
      }
    </style>
  </head>
  <body>
    <header class="dash-header">
      <div class="brand">
        <div class="logo-mark">NR</div>
        <div class="brand-details">
          <p class="eyebrow">Authenticated session</p>
          <h1><span data-user-name>Loading...</span>, welcome back.</h1>
        </div>
      </div>
      <nav class="dash-nav">
        <a href="/dashboard" class="nav-link active">Dashboard</a>
        <a href="/" class="nav-link">Home</a>
        <a href="#profile" class="nav-link">Profile</a>
        <a href="/account-settings" class="nav-link">Account</a>
        <button type="button" id="logoutBtn" class="nav-link logout">Logout</button>
      </nav>
    </header>

    <div class="page-switch" id="pageSwitch" hidden aria-hidden="true">
      <div class="email-toggle" role="tablist" aria-label="Page navigation">
        <button
          type="button"
          class="email-toggle-btn"
          id="pageSwitchHome"
          role="tab"
          aria-selected="false"
        >
          Home
        </button>
        <button
          type="button"
          class="email-toggle-btn"
          id="pageSwitchDashboard"
          role="tab"
          aria-selected="false"
        >
          Dashboard
        </button>
      </div>
    </div>

    <main class="dashboard-shell">
      <section class="panel profile-card" id="profile">
        <div class="profile-identity">
          <img
            id="userAvatar"
            src="https://www.gravatar.com/avatar/?d=mp&s=200"
            alt="User avatar"
            loading="lazy"
            decoding="async"
            fetchpriority="low"
          />
          <div>
            <h2 data-user-name>Loading...</h2>
            <p data-user-email>Fetching email‚Ä¶</p>
          </div>
        </div>
        <dl class="profile-meta">
          <div>
            <dt>Status</dt>
            <dd class="status-badge">Active</dd>
          </div>
          <div>
            <dt>Plan</dt>
            <dd>Creator</dd>
          </div>
          <div>
            <dt>Last sync</dt>
            <dd id="lastSync">‚Äî</dd>
          </div>
        </dl>
      </section>

      <section class="panel">
        <div class="section-heading">
          <h3>Quick actions</h3>
          <span>Focus on what matters</span>
        </div>
        <div class="action-grid">
          <a href="#start-project" class="action-card" data-link-target="start-project">
            <div class="action-icon">‚ö°</div>
            <h4>Start a New Project</h4>
            <p>Launch AI-assisted builds with curated templates tailored to your goals.</p>
          </a>
          <a href="#settings" class="action-card" data-link-target="settings">
            <div class="action-icon">‚öôÔ∏è</div>
            <h4>Settings</h4>
            <p>Adjust workspace preferences, notifications, and integrations.</p>
          </a>
          <a href="#security" class="action-card" data-link-target="security">
            <div class="action-icon">üîê</div>
            <h4>Security & Password</h4>
            <p>Update credentials, enable MFA, and review connected devices.</p>
          </a>
          <a href="#notifications" class="action-card" data-link-target="notifications">
            <div class="action-icon">üì£</div>
            <h4>Notifications</h4>
            <p>Stay ahead with deployment alerts and account automation updates.</p>
          </a>
          <a href="#messages" class="action-card" data-link-target="messages">
            <div class="action-icon">üí¨</div>
            <h4>Messages</h4>
            <p>Collaborate with your team, clients, and NetworkRad advisors.</p>
          </a>
          <a href="#billing" class="action-card" data-link-target="billing">
            <div class="action-icon">üí≥</div>
            <h4>Billing & Payments</h4>
            <p>Manage subscriptions, invoices, and contract milestones.</p>
          </a>
          <a href="#support" class="action-card" data-link-target="support">
            <div class="action-icon">üõ†Ô∏è</div>
            <h4>Support & Help</h4>
            <p>Access the resource hub or open a priority ticket with our team.</p>
          </a>
        </div>
      </section>

      <section class="detail-section" id="start-project">
        <h4>Start a New Project</h4>
        <p>
          Select a blueprint, invite collaborators, and define milestones. NetworkRad AI keeps your
          initiatives on schedule with automated check-ins.
        </p>
      </section>

      <section class="detail-section" id="settings">
        <h4>Workspace Settings</h4>
        <p>
          Personalize dashboard widgets, update your time zone, and connect preferred productivity
          services for seamless automation.
        </p>
      </section>

      <section class="detail-section" id="security">
        <h4>Security & Password</h4>
        <p>
          Review recent sign-ins, rotate keys, and enable biometric approvals to keep your account
          safe.
        </p>
      </section>

      <section class="detail-section" id="notifications">
        <h4>Notifications</h4>
        <p>
          Fine-tune alerts for deploys, payments, and AI insight drops. Deliver updates to Slack,
          email, or SMS.
        </p>
      </section>

      <section class="detail-section" id="messages">
        <h4>Messages</h4>
        <p>
          Catch up with clients and your NetworkRad success partner. Threading keeps context with
          every reply.
        </p>
      </section>

      <section class="detail-section" id="billing">
        <h4>Billing & Payments</h4>
        <p>
          Export invoices, update payment methods, and track renewals in one secure view.
        </p>
      </section>

      <section class="detail-section" id="support">
        <h4>Support & Help</h4>
        <p>
          Access tutorials, performance guides, and open a ticket when you need a human specialist.
        </p>
      </section>
    </main>

    <footer>
      <span>&copy; <span id="year"></span> NetworkRad.</span>
      <a href="#privacy">Privacy Policy</a>
      <a href="#terms">Terms of Service</a>
    </footer>

    <script src="Script.js" defer></script>
    <script>
      (function () {
        const backendBase =
          window.location.origin.includes('5000') || window.location.origin.includes('localhost')
            ? ''
            : 'http://localhost:5000';

        const setUserData = (profile) => {
          document.querySelectorAll('[data-user-name]').forEach((el) => {
            el.textContent = profile?.fullName || profile?.name || 'NetworkRad member';
          });
          document.querySelectorAll('[data-user-email]').forEach((el) => {
            el.textContent = profile?.email || 'Email unavailable';
          });
          const avatar = document.getElementById('userAvatar');
          if (profile?.profilePhoto || profile?.picture) {
            const photo = profile.profilePhoto || profile.picture;
            avatar.src = photo.startsWith('http') ? photo : `${backendBase}/${photo}`;
          }
          avatar.alt = profile?.fullName ? `${profile.fullName}'s avatar` : 'User avatar';
          const lastSync = document.getElementById('lastSync');
          lastSync.textContent = new Date().toLocaleString();
        };

        const fetchProfile = async () => {
          try {
            const res = await fetch(`${backendBase}/api/profile`, {
              credentials: 'include'
            });
            if (!res.ok) throw new Error('Not authenticated');
            const data = await res.json();
            setUserData(data.profile || {});
          } catch (err) {
            window.location.href = `${backendBase || ''}/`;
          }
        };

        const quickLinks = document.querySelectorAll('[data-link-target]');
        quickLinks.forEach((link) => {
          link.addEventListener('click', (event) => {
            event.preventDefault();
            const targetId = link.getAttribute('data-link-target');
            const section = document.getElementById(targetId);
            if (section) {
              section.scrollIntoView({ behavior: 'smooth', block: 'start' });
              section.classList.add('section-highlight');
              setTimeout(() => section.classList.remove('section-highlight'), 1500);
            }
          });
        });

        const logoutBtn = document.getElementById('logoutBtn');
        logoutBtn.addEventListener('click', async () => {
          try {
            await fetch(`${backendBase}/logout`, { credentials: 'include' });
          } finally {
            window.location.href = `${backendBase || ''}/`;
          }
        });

        document.getElementById('year').textContent = new Date().getFullYear();
        fetchProfile();
      })();
    </script>
  </body>
</html>
